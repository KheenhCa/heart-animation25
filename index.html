<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Đ ♥ Y – 1st Anniversary</title>
  <style>
    html, body {
      margin: 0;
      overflow: hidden;
      background: radial-gradient(ellipse at center, #000010, #000000);
    }
    canvas {
      display: block;
    }
  </style>
</head>
<body>
<canvas id="canvas"></canvas>
<script>
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

let width = canvas.width;
let height = canvas.height;
let centerX = width / 2;
let centerY = height / 2;

let phase = "flyIn"; // flyIn -> explode -> stars

const particles = [];
const stars = [];
const textPoints = [];

function heartFunc(t) {
  const x = 16 * Math.pow(Math.sin(t), 3);
  const y = 13 * Math.cos(t) - 5 * Math.cos(2 * t) - 2 * Math.cos(3 * t) - Math.cos(4 * t);
  return { x: x * 10, y: -y * 10 };
}

// Tạo các điểm trái tim đích
const heartTarget = [];
for (let i = 0; i < 1000; i++) {
  let t = Math.random() * Math.PI * 2;
  let { x, y } = heartFunc(t);
  heartTarget.push({ x: centerX + x, y: centerY + y });
}

// Tạo các vệt sáng bay vào
for (let i = 0; i < heartTarget.length; i++) {
  let target = heartTarget[i];
  particles.push({
    x: Math.random() * width,
    y: Math.random() * height,
    dx: 0,
    dy: 0,
    targetX: target.x,
    targetY: target.y,
    size: Math.random() * 2 + 1,
    reached: false
  });
}

let exploded = false;
let explosionTime = 0;

// Tạo các ngôi sao nền mờ
for (let i = 0; i < 300; i++) {
  stars.push({
    x: Math.random() * width,
    y: Math.random() * height,
    size: Math.random() * 1.5 + 0.5,
    alpha: Math.random() * 0.5 + 0.2
  });
}

function drawStars() {
  for (let s of stars) {
    ctx.beginPath();
    ctx.arc(s.x, s.y, s.size, 0, Math.PI * 2);
    ctx.fillStyle = `rgba(255,255,255,${s.alpha})`;
    ctx.fill();
  }
}

function drawTextStars() {
  ctx.save();
  ctx.font = "bold 60px Arial";
  ctx.textAlign = "center";
  ctx.fillStyle = "white";
  ctx.shadowColor = "rgba(255,255,255,0.8)";
  ctx.shadowBlur = 15;

  ctx.globalAlpha = 0.8 + 0.2 * Math.sin(Date.now() / 500);
  ctx.fillText("Đ ♥ Y", centerX, centerY - 30);
  ctx.font = "30px Arial";
  ctx.fillText("1st Anniversary", centerX, centerY + 30);
  ctx.restore();
}

function animate() {
  ctx.fillStyle = "rgba(0,0,10,0.15)";
  ctx.fillRect(0, 0, width, height);

  drawStars();

  if (phase === "flyIn") {
    let complete = 0;
    for (let p of particles) {
      let dx = (p.targetX - p.x) * 0.05;
      let dy = (p.targetY - p.y) * 0.05;
      p.x += dx;
      p.y += dy;

      if (Math.abs(dx) < 0.5 && Math.abs(dy) < 0.5) {
        p.reached = true;
        complete++;
      }

      ctx.beginPath();
      ctx.arc(p.x, p.y, p.size, 0, Math.PI * 2);
      ctx.fillStyle = "rgba(255,100,150,0.8)";
      ctx.shadowColor = "#ff66cc";
      ctx.shadowBlur = 20;
      ctx.fill();
    }

    if (complete > particles.length * 0.95) {
      phase = "explode";
      explosionTime = Date.now();
    }

  } else if (phase === "explode") {
    if (!exploded) {
      for (let p of particles) {
        p.dx = (Math.random() - 0.5) * 10;
        p.dy = (Math.random() - 0.5) * 10;
      }
      exploded = true;
    }

    for (let p of particles) {
      p.x += p.dx;
      p.y += p.dy;
      p.size *= 0.98;

      ctx.beginPath();
      ctx.arc(p.x, p.y, p.size, 0, Math.PI * 2);
      ctx.fillStyle = "rgba(255,200,200,0.5)";
      ctx.shadowColor = "#ffcccc";
      ctx.shadowBlur = 10;
      ctx.fill();
    }

    if (Date.now() - explosionTime > 2000) {
      phase = "stars";
    }

  } else if (phase === "stars") {
    drawTextStars();
  }

  requestAnimationFrame(animate);
}

animate();

window.addEventListener("resize", () => {
  canvas.width = width = window.innerWidth;
  canvas.height = height = window.innerHeight;
  centerX = width / 2;
  centerY = height / 2;
});
</script>
</body>
</html>
